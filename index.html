
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horloge du Bitcoin - France</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Arial:wght@400;700&display=swap');
        body { 
            font-family: 'Arial', sans-serif; 
            background: #000; 
            color: #fff; 
            margin: 0; 
            padding: 0; 
            overflow: auto;
        }
        .container { display: flex; min-height: 100vh; }
        .left { 
            flex: 1; 
            padding: 40px; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            background: #000; 
        }
        .right { 
            flex: 1; 
            padding: 40px; 
            background: #111; 
        }
        h1 { 
            font-size: 2.5em; 
            color: #F7931A; 
            margin-bottom: 20px; 
            text-align: center;
        }
        p { color: #ccc; text-align: center; margin-bottom: 40px; }
        .counter { 
            font-size: 2.5em; 
            font-weight: 700; 
            margin: 20px 0; 
            padding: 20px; 
            background: rgba(247, 147, 26, 0.1); 
            border: 2px solid #F7931A; 
            border-radius: 8px; 
            box-shadow: 0 0 10px rgba(247, 147, 26, 0.3); 
            color: #fff;
            transition: all 0.3s ease;
        }
        .label { 
            font-size: 1.2em; 
            color: #F7931A; 
            margin-bottom: 10px; 
            text-align: center;
        }
        h2 { color: #F7931A; text-align: center; margin-bottom: 20px; }
        #powerLawChart { 
            max-height: 500px; 
            background: #000; 
            border-radius: 8px; 
            border: 1px solid #F7931A; 
            margin-bottom: 20px;
        }
        .additional-text { 
            color: #ccc; 
            font-size: 0.9em; 
            text-align: left; 
            line-height: 1.6;
        }
        .additional-text ul { 
            list-style-type: none; 
            padding-left: 0; 
        }
        .additional-text li { 
            margin-bottom: 10px; 
            padding-left: 20px; 
            position: relative; 
        }
        .additional-text li::before { 
            content: "•"; 
            color: #F7931A; 
            font-weight: bold; 
            position: absolute; 
            left: 0; 
        }
        a:link {
            color: orange;
            background-color: transparent;
            text-decoration: none;
        }

        a:visited {
        color: orange;
        background-color: transparent;
        text-decoration: none;
        }

        a:hover {
        color: red;
        background-color: transparent;
        text-decoration: underline;
        }

        a:active {
        color: orange;
        background-color: transparent;
        text-decoration: underline;
        }
        .updating { color: #ccc; font-size: 0.9em; text-align: center; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="left">
            <h1>Horloge du Bitcoin - France</h1>
            <p>Coût d'opportunité si la France avait miné 10% de la puissance globale depuis 2018. Mises à jour en temps réel toutes les 10 minutes.</p>
            
            <div class="label">Total Manqués (€)</div>
            <div class="counter" id="totalEurosCounter">0</div>
            
            <div class="label">BTC Manqués</div>
            <div class="counter" id="btcCounter">0</div>
            
            <div class="label">Prix BTC Actuel (€)</div>
            <div class="counter" id="priceCounter">0</div>
            
            <div class="label">Blocs Manqués</div>
            <div class="counter" id="blocksCounter">0</div>
            
            <div class="updating" id="updateText">Mise à jour en temps réel via API.</div>
        </div>
        
        <div class="right">
            <h2>Prix Historique BTC (EUR)</h2>
            <canvas id="powerLawChart"></canvas>
            <div class="additional-text">
                <ul>
                    <li>Ce gaspillage n'inclut pas les potentiels retombées économiques de réindustrialiser la France avec une nouvelle industrie innovante.</li>
                    <li>La création d'emplois dans des régions rurales et là où les containers et les industriels du minage peuvent s'implémenter.</li>
                    <li>La potentielle mise en place de circularité en injectant une partie des profits dans les collectivités locales.</li>
                    <li><a href="https://cellulehumaine.substack.com/p/coming-soon">Bitcoin c'est de la science</a>, il serait temps de se remettre à la science.</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Fonction pour calculer les BTC minés (miroir du Python)
        function calculateMinedBtc(currentBlock) {
            let totalBtc = 0.0;
            const startBlock = 499500;
            
            // Période 1 : ~499500 à 630000 (12.5 BTC)
            const halving1End = 630000;
            let blocks1 = Math.max(0, Math.min(halving1End, currentBlock) - Math.max(startBlock, 499500));
            totalBtc += blocks1 * 12.5;
            
            // Période 2 : 630000 à 840000 (6.25 BTC)
            const halving2Start = 630000;
            const halving2End = 840000;
            let blocks2Start = Math.max(startBlock, halving2Start);
            let blocks2End = Math.min(halving2End, currentBlock);
            let blocks2 = Math.max(0, blocks2End - blocks2Start);
            totalBtc += blocks2 * 6.25;
            
            // Période 3 : 840000+ (3.125 BTC)
            const halving3Start = 840000;
            let blocks3Start = Math.max(startBlock, halving3Start);
            let blocks3End = currentBlock;
            let blocks3 = Math.max(0, blocks3End - blocks3Start);
            totalBtc += blocks3 * 3.125;
            
            return totalBtc;
        }

        // Animation fluide des compteurs
        function animateCounter(id, target, duration = 2000, suffix = '') {
            const counter = document.getElementById(id);
            const start = parseFloat(counter.textContent.replace(/,/g, '').replace(/[^0-9.-]/g, '')) || 0;
            const range = target - start;
            const increment = range / (duration / 16);
            let current = start;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                if (id === 'totalEurosCounter' || id === 'btcCounter' || id === 'blocksCounter') {
                    counter.textContent = Math.floor(current).toLocaleString() + suffix;
                } else {
                    counter.textContent = current.toFixed(2).toLocaleString() + suffix;
                }
            }, 16);
        }

        // Données embeddées initiales
        const initialTotalEuros = 31059638160;
        const initialBtc = 318442.8125;
        const initialPrice = 97536;
        const initialBlocks = 417517;
        const histData = [{"x": 2018.0, "y": 10000}, {"x": 2025.0, "y": 97000}];
        const share = 0.1;
        const startBlock = 499500;
        const initialCurrentBlock = 917017;

        let lastHeight = initialCurrentBlock;
        let lastPrice = initialPrice;

        // Fonction de mise à jour en temps réel
        async function updateData() {
            try {
                const heightRes = await fetch('https://blockstream.info/api/blocks/tip/height');
                const heightText = await heightRes.text();
                const newHeight = parseInt(heightText);
                
                const priceRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=eur');
                const priceData = await priceRes.json();
                const newPrice = priceData.bitcoin.eur;
                
                const newTotalMined = calculateMinedBtc(newHeight);
                const newTotalBtc = newTotalMined * share;
                const newTotalEuros = Math.floor(newTotalBtc * newPrice);
                const newBlocks = newHeight - startBlock;
                
                // Animation vers les nouvelles valeurs
                animateCounter('totalEurosCounter', newTotalEuros, 1000, ' €');
                animateCounter('btcCounter', newTotalBtc, 1000, ' BTC');
                animateCounter('priceCounter', newPrice, 1000, ' €');
                animateCounter('blocksCounter', newBlocks, 1000, '');
                
                // Mise à jour du timestamp
                document.getElementById('updateText').textContent = `Dernière mise à jour: ${new Date().toLocaleString('fr-FR')}`;
                
                lastHeight = newHeight;
                lastPrice = newPrice;
            } catch (e) {
                console.error('Erreur lors de la mise à jour:', e);
            }
        }

        // Initialisation
        window.onload = () => {
            // Animation initiale
            document.getElementById('totalEurosCounter').textContent = '0';
            document.getElementById('btcCounter').textContent = '0';
            document.getElementById('priceCounter').textContent = '0';
            document.getElementById('blocksCounter').textContent = '0';
            
            animateCounter('totalEurosCounter', initialTotalEuros, 3000, ' €');
            animateCounter('btcCounter', initialBtc, 3000, ' BTC');
            animateCounter('priceCounter', initialPrice, 2000, ' €');
            animateCounter('blocksCounter', initialBlocks, 2000, '');
            
            // Graphique Chart.js (historique seulement)
            const ctx = document.getElementById('powerLawChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'Prix Historique (EUR)',
                            data: histData,
                            borderColor: '#F7931A',
                            backgroundColor: 'rgba(247, 147, 26, 0.1)',
                            tension: 0.1,
                            pointRadius: 0,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            title: { display: true, text: 'Année', color: '#fff' }
                        },
                        y: {
                            type: 'linear',
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            title: { display: true, text: 'Prix BTC (EUR)', color: '#fff' },
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#fff' } }
                    }
                }
            });
            
            // Première mise à jour immédiate pour synchroniser
            setTimeout(updateData, 1000);
            
            // Mises à jour toutes les 10 minutes
            setInterval(updateData, 600000);
        };
    </script>
</body>
</html>
    
